var f=(e,u,p)=>new Promise((i,d)=>{var _=s=>{try{a(p.next(s))}catch(r){d(r)}},m=s=>{try{a(p.throw(s))}catch(r){d(r)}},a=s=>s.done?i(s.value):Promise.resolve(s.value).then(_,m);a((p=p.apply(e,u)).next())});import{l as A,n as j}from"./index.62164120.js";import{s as U}from"./componentSetting.a3b3dac8.js";import{u as S}from"./app.ce630fce.js";import{d as L,r as C,b as N,u as $,I as O,$ as V,y as M,a0 as c,x as P,o as v,z as y,w as n,i as l,a as T,l as I,c as J,Q,M as R,k as g,t as B,B as q,m as z,_ as G,cQ as H,cR as K,C as W,p as X,q as Y,aa as Z}from"./index.59f76cad.js";const{project:x}=U,F=S(),k={id:0,project_id:null,manager_id:0,title:"",price:0,key_prefix:"",level_id:0,days:0,points:0,key_ext_attr:"",tag:"",is_lock:0},ee=L({props:{show:{type:Boolean,default:!1},title:{type:String,default:""},form:{type:Object,default(){return k}}},setup(e,{emit:u}){const{keys_type_lock:p}=x,i=C(!1),d=N({}),_=$(),m=O();let a=null;const s=V(()=>{let o=JSON.parse(JSON.stringify(F.getProjectList));return o.unshift({name:"\u901A\u7528\u9879\u76EE-\u6240\u6709\u9879\u76EE\u90FD\u53EF\u7528",id:0}),o}),r=C({id:0,project_id:null,manager_id:0,title:"",price:0,key_prefix:"",level_id:0,days:0,points:0,key_ext_attr:"",tag:"",is_lock:0}),D=()=>f(this,null,function*(){if(a=_.create("\u52A0\u8F7D\u4E2D...",{type:"loading",duration:1e4}),r.value.id>0)m.warning({title:"\u6E29\u99A8\u63D0\u793A",content:"\u4FEE\u6539\u5DF2\u7ECF\u521B\u5EFA\u7684\u6FC0\u6D3B\u7801\u7C7B\u578B\uFF0C\u5C06\u4F1A\u5BFC\u81F4\u5DF2\u7ECF\u521B\u5EFA\u4E14\u672A\u4F7F\u7528\u7684\u6FC0\u6D3B\u7801\u5C5E\u6027\u8DDF\u968F\u53D8\u6362\uFF0C\u5982\u975E\u5FC5\u8981\u8BF7\u52FF\u4FEE\u6539\u5929\u6570\u70B9\u6570\u5C5E\u6027",positiveText:"\u786E\u5B9A",negativeText:"\u53D6\u6D88",onPositiveClick:()=>f(this,null,function*(){let o=yield A(r.value);o!==void 0&&o>0?(i.value=!1,a.destroy(),u("on-update"),yield F.fetchCardList(!0)):a.destroy()}),onNegativeClick:()=>{_.error("\u53D6\u6D88\u64CD\u4F5C"),a.destroy()}});else{let o=yield j(r.value);o!==void 0&&o>0?(i.value=!1,a.destroy(),u("on-update"),yield F.fetchCardList(!0)):a.destroy()}});return M(()=>f(this,null,function*(){i.value=e.show,yield F.fetchProjectList(!1)})),c(()=>e.show,o=>{i.value=o}),c(()=>e.form,o=>{o===null?r.value=k:r.value=o}),c(i,o=>{u("update:show",o)}),{keys_type_lock:p,formData:r,rules:d,modalShow:i,handleOk:D,projectList:s}}});const ue={class:"form-view"};function ae(e,u,p,i,d,_){const m=q,a=z,s=G,r=H,D=K,o=W,w=X,h=Y,b=Z;return v(),y(b,{title:e.title,style:{width:"600px"},preset:"card",show:e.modalShow,"onUpdate:show":u[9]||(u[9]=t=>e.modalShow=t)},{default:n(()=>[l(h,{ref:"formRef",inline:!1,"label-width":80,model:e.formData,rules:e.rules},{default:n(()=>[T("div",ue,[e.formData.id===0?(v(),y(a,{key:0,label:"\u5F52\u5C5E\u9879\u76EE",path:"project_id"},{default:n(()=>[l(m,{"label-field":"name","value-field":"id",value:e.formData.project_id,"onUpdate:value":u[0]||(u[0]=t=>e.formData.project_id=t),options:e.projectList,placeholder:"\u8BF7\u9009\u62E9\u5F52\u5C5E\u9879\u76EE"},null,8,["value","options"])]),_:1})):I("",!0),l(a,{label:"\u6FC0\u6D3B\u7801\u7C7B\u578B",path:"title"},{default:n(()=>[l(s,{maxlength:28,value:e.formData.title,"onUpdate:value":u[1]||(u[1]=t=>e.formData.title=t),placeholder:"\u8F93\u5165\u6FC0\u6D3B\u7801\u7C7B\u578B\u540D\u79F0"},null,8,["value"])]),_:1}),l(a,{label:"\u542F\u7528\u72B6\u6001",path:"is_lock"},{default:n(()=>[l(D,{value:e.formData.is_lock,"onUpdate:value":u[2]||(u[2]=t=>e.formData.is_lock=t),name:"is_lock"},{default:n(()=>[(v(!0),J(Q,null,R(e.keys_type_lock,(t,E)=>(v(),y(r,{value:E,key:E},{default:n(()=>[g(B(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),l(a,{label:"\u524D\u7F00",path:"key_prefix"},{default:n(()=>[l(s,{maxlength:4,value:e.formData.key_prefix,"onUpdate:value":u[3]||(u[3]=t=>e.formData.key_prefix=t),placeholder:"\u8F93\u51654\u4F4D\u6570\u524D\u7F00\uFF08\u5B57\u6BCD\u6216\u8005\u6570\u5B57\u7EC4\u5408\uFF09\u53EF\u7A7A"},null,8,["value"])]),_:1}),l(a,{label:"\u5B9A\u4EF7",path:"price"},{default:n(()=>[l(o,{value:e.formData.price,"onUpdate:value":u[4]||(u[4]=t=>e.formData.price=t),min:0,max:999999,step:.01,clearable:""},null,8,["value","step"])]),_:1}),l(a,{label:"\u5929\u6570",path:"days"},{default:n(()=>[l(o,{value:e.formData.days,"onUpdate:value":u[5]||(u[5]=t=>e.formData.days=t),min:0,max:999999,step:.01,clearable:""},null,8,["value","step"])]),_:1}),l(a,{label:"\u70B9\u6570",path:"points"},{default:n(()=>[l(o,{value:e.formData.points,"onUpdate:value":u[6]||(u[6]=t=>e.formData.points=t),min:0,max:99999,step:1,clearable:""},null,8,["value"])]),_:1}),l(a,{label:"\u6807\u7B7E",path:"tag"},{default:n(()=>[l(s,{maxlength:200,value:e.formData.tag,"onUpdate:value":u[7]||(u[7]=t=>e.formData.tag=t),placeholder:"\u8F93\u5165\u6FC0\u6D3B\u7801\u7ED1\u5B9A\u6807\u7B7E"},null,8,["value"])]),_:1}),l(a,{label:"\u9644\u52A0\u5C5E\u6027",path:"key_ext_attr"},{default:n(()=>[l(s,{maxlength:200,value:e.formData.key_ext_attr,"onUpdate:value":u[8]||(u[8]=t=>e.formData.key_ext_attr=t),placeholder:"\u8F93\u5165\u6FC0\u6D3B\u7801\u7ED1\u5B9A\u9644\u52A0\u5C5E\u6027"},null,8,["value"])]),_:1})]),l(a,null,{default:n(()=>[l(w,{type:"primary","attr-type":"button",onClick:e.handleOk},{default:n(()=>[g(B(e.title),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","show"])}const re=P(ee,[["render",ae],["__scopeId","data-v-f21a35c5"]]);export{re as default};
