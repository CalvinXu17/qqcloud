var g=(t,o,u)=>new Promise((m,r)=>{var v=a=>{try{n(u.next(a))}catch(l){r(l)}},d=a=>{try{n(u.throw(a))}catch(l){r(l)}},n=a=>a.done?m(a.value):Promise.resolve(a.value).then(v,d);n((u=u.apply(t,o)).next())});import{V as C,Y as O,W as E,X as U}from"./index.62164120.js";import{s as B}from"./componentSetting.a3b3dac8.js";import{u as N}from"./app.ce630fce.js";import{d as V,r as f,b as $,u as J,y as L,a0 as k,H as R,df as j,x as A,o as K,z as M,w as p,i as s,k as P,t as T,_ as q,m as z,a1 as H,a9 as I,p as W,q as X,aa as Y}from"./index.59f76cad.js";import{_ as G}from"./Transfer.f3250f1b.js";const{project:Q}=B,D=N(),F={id:0,title:"",description:""},Z=V({props:{show:{type:Boolean,default:!1},title:{type:String,default:""},form:{type:Object,default(){return F}}},setup(t,{emit:o}){const u=f([]),{keys_type_lock:m}=Q,r=f(!1),v=$({}),d=J();let n=null;const a=f([]),l=f({id:0,title:"",description:""}),c=f([]),h=function({onCheck:e,pattern:i}){return R(j,{style:"margin: 0 4px;",keyField:"name",labelField:"name",checkable:!0,selectable:!1,blockLine:!0,checkOnClick:!0,data:a.value,pattern:i,checkedKeys:u.value,onUpdateCheckedKeys:_=>{console.log("checkedKeys",_),e(_)}})};function w(e){const i=[];console.log(e);function _(S=[]){S.forEach(y=>{i.push({label:y.name,value:y.name}),y.children!==null&&_(y.children)})}return _(e),i}const b=()=>g(this,null,function*(){n=d.create("\u52A0\u8F7D\u4E2D...",{type:"loading",duration:1e4});let e=JSON.parse(JSON.stringify(l.value));if(e.name=JSON.stringify(u.value),l.value.id>0){let i=yield E(e);i!==void 0&&i>0?(r.value=!1,n.destroy(),o("on-update"),yield D.fetchCardList(!0)):n.destroy()}else{let i=yield U(e);i!==void 0&&i>0?(r.value=!1,n.destroy(),o("on-update")):n.destroy()}});return L(()=>g(this,null,function*(){r.value=t.show,yield D.fetchProjectList(!1),a.value=yield C({}),c.value=w(JSON.parse(JSON.stringify(a.value))),console.log(c.value)})),k(()=>t.show,e=>{r.value=e}),k(()=>t.form,e=>g(this,null,function*(){console.log(e),e===null?l.value=F:(l.value=e,e.id>0&&(u.value=yield O({role_id:e.id})))})),k(r,e=>{o("update:show",e)}),{options:c,keys_type_lock:m,formData:l,rules:v,modalShow:r,handleOk:b,treeVal:u,renderSourceList:h}}});function x(t,o,u,m,r,v){const d=q,n=z,a=H,l=G,c=I,h=W,w=X,b=Y;return K(),M(b,{title:t.title,style:{width:"800px"},preset:"card",show:t.modalShow,"onUpdate:show":o[3]||(o[3]=e=>t.modalShow=e)},{default:p(()=>[s(w,{ref:"formRef",inline:!1,"label-width":80,model:t.formData,rules:t.rules},{default:p(()=>[s(c,{type:"line",animated:""},{default:p(()=>[s(a,{name:"1",tab:"\u57FA\u7840\u8BBE\u7F6E"},{default:p(()=>[s(n,{label:"\u89D2\u8272\u540D\u79F0",path:"title"},{default:p(()=>[s(d,{value:t.formData.title,"onUpdate:value":o[0]||(o[0]=e=>t.formData.title=e),placeholder:"\u8F93\u5165\u89D2\u8272\u540D\u79F0"},null,8,["value"])]),_:1}),s(n,{label:"\u89D2\u8272\u63CF\u8FF0",path:"description"},{default:p(()=>[s(d,{value:t.formData.description,"onUpdate:value":o[1]||(o[1]=e=>t.formData.description=e),placeholder:"\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"},null,8,["value"])]),_:1})]),_:1}),s(a,{name:"2",tab:"\u6743\u9650\u8BBE\u7F6E"},{default:p(()=>[s(l,{ref:"transfer",value:t.treeVal,"onUpdate:value":o[2]||(o[2]=e=>t.treeVal=e),options:t.options,"render-source-list":t.renderSourceList,"source-filterable":""},null,8,["value","options","render-source-list"])]),_:1})]),_:1}),s(n,null,{default:p(()=>[s(h,{type:"primary","attr-type":"button",onClick:t.handleOk},{default:p(()=>[P(T(t.title),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","show"])}const se=A(Z,[["render",x],["__scopeId","data-v-8ac77df6"]]);export{se as default};
